<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to use the Shiny app to analyze causal graphs • causaloptim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to use the Shiny app to analyze causal graphs">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">causaloptim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/shinyapp.html">How to use the Shiny app to analyze causal graphs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>How to use the Shiny app to analyze causal graphs</h1>
            
      
      
      <div class="hidden name"><code>shinyapp.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(causaloptim)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#&gt; Loading required package: shiny</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt; Loading required package: igraph</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt; Attaching package: 'igraph'</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt;     decompose, spectrum</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; The following object is masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt;     union</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt; Loading required package: markdown</span></a></code></pre></div>
<p>Run the Shiny application like so. The result is assigned to an objected called <code>results</code> so that you can save the results that are produced in the web interface.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/specify_graph.html">specify_graph</a></span>()</a></code></pre></div>
<p>A new window in your system’s default web browser is opened with the following interface:</p>
<div class="figure">
<img src="../../../../Box%20Sync/R%20projects/causaloptim/vignettes/screen1.png" alt="Application start"><p class="caption">Application start</p>
</div>
<p>The instructions at the top provide details on how to specify the graph. The graph is divided into a left side and a right side. There is no confounding allowed between the left and right sides. All variables on the right side are confounded. Connections between the left and right sides must originate from the left. I.e, no connections from the right to left are allowed. On the left side, arbitrary connections are allowed and the model assumes that all nodes are observed and connected. On the right side, unmeasured variables are allowed, and the procedure assumes unmeasured confounding between all nodes. These restrictions are sufficient to ensure that the problem can be solved analytically using linear optimization.</p>
<p>In the main window below the text, Shift+click to add nodes. When a node is added, you are prompted to give it a name. Make sure that you use a valid R variable name. This means it cannot start with a number, and cannot contain spaces or special characters. Single capital letters are good choices, possibly with trailing numbers.</p>
<div class="figure">
<img src="../../../../Box%20Sync/R%20projects/causaloptim/vignettes/screen2.png" alt="Naming nodes"><p class="caption">Naming nodes</p>
</div>
<p>Click on an existing node to select it, and shift+click on a node to change the name. Shift+drag to connect nodes. Remember than no edges may go from the right side to the left side. Click a node to select and then press ‘u’ to mark it as unobserved/latent. Click to select nodes/edges and press delete to remove. If there are problems selecting nodes, try restarting your browser.</p>
<div class="figure">
<img src="../../../../Box%20Sync/R%20projects/causaloptim/vignettes/screen3.png" alt="Connections"><p class="caption">Connections</p>
</div>
<p>Once we have our graph specified, we can optionally make some annotations. You must specify the outcome of interest, and the exposure of interest. Select the outcome node and press ‘y’ to mark it as the outcome of interest, and then select the exposure node and press ‘e’ to mark it as the exposure of interest. The default causal contrast is the total effect. The exposure will be colored blue, and the outcome colored red.</p>
<div class="figure">
<img src="../../../../Box%20Sync/R%20projects/causaloptim/vignettes/screen4.png" alt="Final graph"><p class="caption">Final graph</p>
</div>
<p>We now have a graph specified that is ready to be analyzed. Optionally, click an edge and press ‘m’ to enforce monotonicity for that connection. If you are ready to analyze the object click on the “Press to analyze the graph button”. The program interprets the graph, converts it to an <code>igraph</code> object with annotations, and prints the result from R. Inspect the resulting graph carefully so that you understand what is being analyzed.</p>
<div id="specifying-the-causal-effect-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#specifying-the-causal-effect-of-interest" class="anchor"></a>Specifying the causal effect of interest</h2>
<p>The next step is to use the buttons to specify the causal effect of interest. In our current example, we are interested in the causal risk difference in Y comparing X = 1 to X = 0, i.e., Y(X = 1) - Y(X = 0). The optimizer will compute bounds for the expected value of this quantity.</p>
<div class="figure">
<img src="../../../../Box%20Sync/R%20projects/causaloptim/vignettes/screen5.png" alt="Interpreted graph"><p class="caption">Interpreted graph</p>
</div>
<p>Use the buttons to describe your causal effect of interest. The following buttons are available to make this specification:</p>
<ul>
<li>
<strong>Add potential outcome</strong>: This button adds one of the variables as a potential outcome that depends on one or more of its parents. Click the button, and then select the outcome from the dropdown list. In this example, we click and select the “Y” variable.
<ul>
<li>Once you have selected a potential outcome, you must specify what it depends on, which will be indicated by the parentheses. An outcome can depend on a <em>variable</em>, that is, one of its parents in the graph whose value is fixed to 0 or 1, or on a <em>potential condition</em> which is a potential variable that itself depends on the value of one of its parents.</li>
</ul>
</li>
<li>
<strong>Add variable</strong>: This button adds a selector for the parents of the outcome in the current row, and 0 or 1 for the value of that variable. In our example we set the variable X to 1.</li>
<li>
<strong>Add potential condition</strong>: This button adds a selector for the parents of the outcome in the current row, but unlike the variable, these are potential outcomes as well. The condition for the potential outcome depend on the parents of the variable selected, two levels up from the outcome in the current row.</li>
<li>
<strong>Add operator</strong>: This button terminates the selection of variables in the current row, and adds a new row that allows you to select “+” or “-”, which is the operator that is used to combine with the next row. In our example, we click and select “-” for the difference.</li>
<li>
<strong>Reset</strong>: Clears all of the outcomes and operators.</li>
</ul>
<p>If the potential outcome has multiple parents, you can press the add variable or add potential condition button as many times as is needed to define your effect. Continue adding variables, specifying their conditions, and make sure that all rows are separated by an operator.</p>
<p>Our specified effect now looks like this:</p>
<div class="figure">
<img src="../../../../Box%20Sync/R%20projects/causaloptim/vignettes/screen6.png" alt="Specified effect"><p class="caption">Specified effect</p>
</div>
</div>
<div id="specifying-constraints-optional" class="section level2">
<h2 class="hasAnchor">
<a href="#specifying-constraints-optional" class="anchor"></a>Specifying constraints (optional)</h2>
<p>Once the causal effect of interest has been specified, you may optionally specify some constraints. Click the button to start the constraint interface.</p>
<div class="figure">
<img src="../../../../Box%20Sync/R%20projects/causaloptim/vignettes/screen7.png" alt="Constraint interface"><p class="caption">Constraint interface</p>
</div>
<p>Here you can choose potential outcomes to constrain by selecting the potential outcomes, values of their parents, and operators that determine the constraint (equalities or inequalities). In our example, we can specify monotonicity of the instrument Z by defining the constraint X(Z = 1) <span class="math inline">\(\geq\)</span> X(Z = 0).</p>
</div>
<div id="computation-of-the-bounds" class="section level2">
<h2 class="hasAnchor">
<a href="#computation-of-the-bounds" class="anchor"></a>Computation of the bounds</h2>
<p>Once you have inspected the graph, specified the causal effect, and understand what is being analyzed, press the final button to compute the bounds.</p>
<p>The results are summarized in plain text. The bounds are expressed as the minimum/maximum of a series of expressions involving the conditional probabilities of the observed variables. For more details on the method see the paper that doesn’t exist yet. The final button allows you to return all of the objects back to the R environment and store them in <code>results</code>.</p>
<p>The <code>results</code> object contains the graph, the parameterization and interpretation of the graph in terms of the variables and parameters, the bounds and log information about the optimization procedure, and an R function that implements the bounds:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(results)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; [1] "graphres"       "obj"            "bounds.obs"     "boundsFunction"</span></a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(results<span class="op">$</span>boundsFunction)</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; function (p00_0 = NULL, p10_0 = NULL, p01_0 = NULL, p11_0 = NULL, </span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt;     p00_1 = NULL, p10_1 = NULL, p01_1 = NULL, p11_1 = NULL) </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; c(lower = pmin(-p00_0 - p10_0 - p10_1 - 2 * p01_1 + 2, -p00_0 - </span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt;     2 * p10_0 - 3 * p01_0 - p11_0 - p00_1 - p10_1 + 3, -p10_0 - </span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt;     p01_1 + 1, p00_0 - p10_0 + p11_0 + p00_1 + p10_1, -p10_0 - </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt;     p01_0 + 1, -p01_0 - p10_1 + 1, -p10_1 - p01_1 + 1, p00_0 + </span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt;     p10_0 - 2 * p10_1 - p01_1 + 1), upper = pmax(-p00_0 - p10_0 - </span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt;     2 * p01_0 - 2 * p11_0 - p00_1 - 2 * p10_1 - 2 * p01_1 + 2, </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;     p11_0 + p00_1 - 1, -p00_0 - 2 * p10_0 - 2 * p01_0 + p00_1 + </span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt;         p10_1, -p10_0 - p01_0 - p11_0 - p00_1 - p10_1 - p01_1 + </span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt;         1, -p10_0 - p01_0, -p10_1 - p01_1, p00_0 - p10_0 - p01_0 - </span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt;         p00_1 - p10_1, p00_0 + p10_0 + 2 * p01_0 + 2 * p11_0 + </span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt;         p00_1 - p10_1 - p01_1 - 2))</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt; &lt;environment: 0x0000000015698a80&gt;</span></a></code></pre></div>
<p>The results object can also be used to numerically simulate the bounds. Try using the <code>simulate_bounds</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/simulate_bounds.html">simulate_bounds</a></span>(results<span class="op">$</span>obj, results<span class="op">$</span>bounds.obs, <span class="dt">nsim =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(sim)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt;     objective bound.lower bound.upper</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; 1 -0.01832546  -0.4586690   0.3950935</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; 2 -0.05177123  -0.5371866   0.3779118</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; 3  0.14229701  -0.4143377   0.4904940</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; 4  0.07022081  -0.4285236   0.5125227</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; 5  0.03457648  -0.4737698   0.4689701</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; 6  0.07698125  -0.4349287   0.4769577</span></a></code></pre></div>
<p>Please sends any bugs or feedback to <a href="mailto:michael.sachs@ki.se" class="email">michael.sachs@ki.se</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#specifying-the-causal-effect-of-interest">Specifying the causal effect of interest</a></li>
      <li><a href="#specifying-constraints-optional">Specifying constraints (optional)</a></li>
      <li><a href="#computation-of-the-bounds">Computation of the bounds</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michael C Sachs.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
